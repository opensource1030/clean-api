## Customize the test machine
machine:
  php:
    version: 7.0.4

  timezone:
    America/New_York # Set the timezone

  environment:
      CIRCLE_ENV: test

## Customize dependencies
dependencies:
  pre:
    - sed -i 's/^;//' ~/.phpenv/versions/$(phpenv global)/etc/conf.d/xdebug.ini
    - mkdir -p build/logs/coverage_html

  override:
    - composer install --prefer-source --no-interaction
    - bundle install

test:
  override:
    - cp .env.test .env
    - php vendor/bin/phpunit -c phpunit.xml --exclude-group need-review --coverage-clover build/logs/clover.xml 
  post:
    - cp -r build/logs/clover.xml $CIRCLE_ARTIFACTS
    - php vendor/bin/coveralls -v

deployment:
  development:
    branch: master
    commands:
      - bundle exec cap develop deploy
      
general:
  branches:
    ignore:
      - gh-pages # list of branches to ignore

notify:
  webhooks:
    # A list of hook hashes, containing the url field
    - url: https://lit-sea-4960.herokuapp.com/build/
